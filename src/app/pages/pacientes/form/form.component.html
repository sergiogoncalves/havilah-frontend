<div class="pacientes-page">
  <form class="paciente-form">

    <div class="actions-bar" *ngIf="!loading">
      <button
        pButton
        type="button"
        label="Salvar"
        icon="pi pi-check"
        class="p-button-success"
        (click)="save()"
        [disabled]="saving">
      </button>

      <button
        pButton
        type="button"
        label="Novo"
        icon="pi pi-plus"
        class="p-button-info"
        (click)="newRecord()"
        [disabled]="saving">
      </button>

      <button
        pButton
        type="button"
        label="Voltar"
        icon="pi pi-arrow-left"
        class="p-button-secondary"
        (click)="cancel()">
      </button>
    </div>

    <div class="form-scroll">
      <div *ngIf="loading">Carregando...</div>
      <div *ngIf="error" class="p-text-danger">{{ error }}</div>

      <div class="form-field">
        <label for="fullName">Nome completo</label>
        <input id="fullName" type="text" pInputText [(ngModel)]="paciente.fullName" name="fullName" />
      </div>

      <div class="p-grid p-mb-3">
        <div class="p-col-12 p-md-6 form-field p-pr-3">
          <label for="birthDate">Data de Nascimento</label>
          <p-calendar
            inputId="birthDate"
            [(ngModel)]="paciente.birthDate"
            name="birthDate"
            [showIcon]="true"
            dateFormat="dd/mm/yy"
            [style]="{ width: '100%' }"
            [inputStyle]="{ width: '100%' }"></p-calendar>
        </div>

        <div class="p-col-12 p-md-6 form-field p-pl-3">
          <label for="cpf">CPF</label>
          <input id="cpf" type="text" maxlength="14" pInputText [(ngModel)]="paciente.cpf" name="cpf" placeholder="Somente nÃºmeros" style="width: 100%;" />
        </div>
      </div>

      <div class="form-field">
        <label>Contatos</label>
        <div class="contact-row contact-row-flex" *ngFor="let c of paciente.contacts; let i = index">
          <div>
            <p-dropdown [options]="contactTypes" [(ngModel)]="c.type" name="type-{{i}}" optionLabel="label" optionValue="value" placeholder="Tipo" [style]="{ width: '100%' }"></p-dropdown>
          </div>
          <div>
            <input type="text" pInputText [(ngModel)]="c.value" name="value-{{i}}" placeholder="Valor (telefone, e-mail...)" style="width: 100%;" />
          </div>
          <div class="checkbox-cell">
            <p-checkbox binary="true" [(ngModel)]="c.primary" name="primary-{{i}}" (onChange)="setPrimary(i)" inputId="primary-{{i}}" [trueValue]="true" [falseValue]="false" label="Principal"></p-checkbox>
          </div>
          <div class="actions-cell">
            <button pButton type="button" icon="pi pi-trash" class="p-button-rounded p-button-text p-button-danger" (click)="removeContact(i)"></button>
          </div>
        </div>
        <div>
          <button pButton type="button" label="Adicionar contato" icon="pi pi-plus" class="p-button-text" (click)="addContact()"></button>
        </div>
      </div>

    </div>
  </form>
</div>
